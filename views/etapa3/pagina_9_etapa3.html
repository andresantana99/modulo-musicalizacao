<div class="row p-3 mb-4 bg-body-tertiary rounded-3" style="min-height: 400px;">
    <div class="text-center">
        <p class="fs-4">Por fim, neste exercício teremos a demonstração de um Metrônomo. Configure
            a duração dos intervalos de tempo do metrônomo, clique no Play e se divirta.
        </p>
        <br>
    </div>
    <div class="container text-center">
        <div class="row align-items-center">
            <div class="col-12 col-md-6 py-4">
                <div id="" type="button" class="btn w-100"
                    style="min-height: 55px; background-color: #17867C; color: white;"></div>
            </div>
            <div class="col-12 col-md-6">
                <div id="" type="button" class="btn w-100"
                    style="min-height: 55px; background-color: #E6972A; color: white;"></div>
            </div>
            <div class="col-12 col-md-6">
                <div id="" type="button" class="btn w-100"
                    style="min-height: 55px; background-color: #B9C303; color: white;"></div>
            </div>
            <div class="col-12 col-md-6">
                <div id="" type="button" class="btn w-100"
                    style="min-height: 55px; background-color: #820742; color: white;"></div>
            </div>
        </div>
    </div>
    <h4 class="pt-5">Arraste o scroll abaixo para definir a frequência dos intervalos em batidas por minuto (BPM):</h4>
    <div class="container text-center">
        <div class="row justify-content-center p-3">
            <div class="col-12">
                <h4><strong id="titlebpm">10 BPM</strong></h4>
                <input type="range" class="form-range" min="1" max="200" value="10" id="bpm" />
                <audio id="audio" src="clap.wav"></audio>
            </div>
            <div class="col-12">
                <button type="button" class="btn btn-outline-primary" id="play">Play</button>
                <button type="button" class="btn btn-outline-primary" id="play">Play</button>
            </div>
        </div>
    </div>
    <p class="pt-5 fs-4" style="text-align: start !important;"><u>Legenda de Cores</u></p>
    <div class="table-responsive">
        <table class="table">
            <tbody>
                <tr style="width: 50%;">
                    <td style="background-color: #17867C;"><img src="../../assets/img/seminima.png" width="32" height="32"
                        alt="Símbolo Seminima" /></td>
                    <td style="width: 45%;">Semínima</td>
                    <td style="background-color: #B9C303;"><img src="../../assets/img/semicolcheia.png" width="32" height="32"
                        alt="Símbolo Semicolcheia" /></td>
                    <td style="width: 45%;">Semicolcheia</td>
                </tr>
                <tr>
                    <td style="background-color: #E6972A;"><img src="../../assets/img/colcheia.png" width="32" height="32"
                        alt="Símbolo Colcheia" /></td>
                    <td>Colcheia</td>
                    <td style="background-color: #820742;"><img src="../../assets/img/semibreve.png" width="32" height="32"
                        alt="Símbolo Semibreve" /></td>
                    <td>Semibreve</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        let numeroCompasso = 0;
        let figurasPrimeiroCompasso = 0;
        let figurasSegundoCompasso = 0;

        $("#btnSeminima").click(function (e) { adicionaFigura(this.id); });
        $("#btnColcheia").click(function (e) { adicionaFigura(this.id); });
        $("#btnSemicolcheia").click(function (e) { adicionaFigura(this.id); });
        $("#btnSemibreve").click(function (e) { adicionaFigura(this.id); });

        function adicionaFigura(botao) {

            if (figurasPrimeiroCompasso < 2) {
                numeroCompasso = 1;
                figurasPrimeiroCompasso++;
            } else if (figurasSegundoCompasso < 2) {
                numeroCompasso = 2;
                figurasSegundoCompasso++;
            } else {
                numeroCompasso = 0;
                Swal.fire({
                    icon: "warning",
                    title: "Compasso Completo!",
                    confirmButtonColor: "#28A745",
                    cancelButtonColor: "#DC3545",
                    showCancelButton: true,
                    confirmButtonText: "Sim",
                    cancelButtonText: "Não",
                    html: "Todas as unidades de tempo dos dois compassos já foram preenchidas. Você deseja limpar os compassos e começar novamente?",
                }).then((result) => {
                    if (result.isConfirmed) {
                        limparCompassos();
                        Swal.fire({
                            icon: "success",
                            title: "Feito!",
                            timer: 1500,
                            showConfirmButton: false,
                            timerProgressBar: true,
                        });
                    }
                });
                return;
            }

            if (numeroCompasso == 0) {
                Swal.fire({
                    icon: "error",
                    title: "Erro inesperado!",
                    html: "Por favor, tente novamente mais tarde.",
                    confirmButtonColor: "#3085d6",
                    footer: '<a href="https://github.com/andresantana99/modulo-musicalizacao">Precisa de ajuda? Contate-nos.</a>',
                });
                return;
            }

            let auxiliar;
            switch (botao) {
                case "btnSemibreve":
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #820742; width: 50% !important;"></td>`);

                    auxiliar = parseInt($(`#th-${numeroCompasso}`).attr("colspan"));
                    $(`#th-${numeroCompasso}`).attr("colspan", auxiliar + 1);
                    break;

                case "btnSeminima":
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #17867C; width: 25% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #17867C; width: 25% !important;"></td>`);

                    auxiliar = parseInt($(`#th-${numeroCompasso}`).attr("colspan"));
                    $(`#th-${numeroCompasso}`).attr("colspan", auxiliar + 2);
                    break;

                case "btnColcheia":
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #E6972A; width: 12.5% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #E6972A; width: 12.5% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #E6972A; width: 12.5% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #E6972A; width: 12.5% !important;"></td>`);

                    auxiliar = parseInt($(`#th-${numeroCompasso}`).attr("colspan"));
                    $(`#th-${numeroCompasso}`).attr("colspan", auxiliar + 4);
                    break;

                case "btnSemicolcheia":
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #B9C303; width: 6.25% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #B9C303; width: 6.25% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #B9C303; width: 6.25% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #B9C303; width: 6.25% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #B9C303; width: 6.25% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #B9C303; width: 6.25% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #B9C303; width: 6.25% !important;"></td>`);
                    $(`.compasso-${numeroCompasso}`).append(`<td style="background-color: #B9C303; width: 6.25% !important;"></td>`);

                    auxiliar = parseInt($(`#th-${numeroCompasso}`).attr("colspan"));
                    $(`#th-${numeroCompasso}`).attr("colspan", auxiliar + 8);
                    break;

                default:
                    Swal.fire({
                        icon: "error",
                        title: "Erro inesperado!",
                        html: "Por favor, tente novamente mais tarde.",
                        confirmButtonColor: "#3085d6",
                        footer: '<a href="https://github.com/andresantana99/modulo-musicalizacao">Precisa de ajuda? Contate-nos.</a>',
                    });
                    break;
            }
        }

        function limparCompassos() {
            $(".unidades-tempo").children("td").remove();
            numeroCompasso = figurasPrimeiroCompasso = figurasSegundoCompasso = 0;
        }
    });
</script>